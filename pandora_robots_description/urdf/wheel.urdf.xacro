<?xml version="1.0" ?>

<robot xmlns:xacro="http://ros.org/wiki/xacro" >
      
  <xacro:macro name="wheel_caster" params="prefix_y prefix_x reflect_y reflect_x" >
  
    <link name="${prefix_y}_${prefix_x}_wheel_link" >
      <inertial>
        <origin xyz="${reflect_y*(-2.2235E-05)} ${reflect_y*(-0.00052624)} 2.4287E-05"
                rpy="0 0 0" />
        <mass value="1.2128" />
        <inertia ixx="0.0032586" ixy="5.862E-08" ixz="${reflect_y*(4.2142E-07)}"
	               iyy="0.0054812" iyz="${reflect_y*(-6.4028E-08)}" izz="0.0032574" />
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 ${(1-reflect_y)*1.57}" />
        <geometry>
          <mesh filename="package://pandora_robots_description/meshes/gears/wheel_link.stl" />
        </geometry>
        <material name="" >
          <color rgba="0.753 0.753 0.753 1" />
        </material>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 ${(1-reflect_y)*1.57}" />
        <geometry>
		      <!-- TODO: Simplify mesh -->
          <mesh filename="package://pandora_robots_description/meshes/gears/wheel_link.stl" />
        </geometry>
      </collision>
    </link>
  
    <joint name="${prefix_y}_${prefix_x}_wheel_joint" type="continuous" >
      <origin xyz="${reflect_x*0.198785} ${reflect_y*0.110545} -0.052795"
	            rpy="0 0 0" />
      <parent link="${prefix_y}_side_link" />
      <child link="${prefix_y}_${prefix_x}_wheel_link" />
      <axis xyz="0 1 0" />
	    <limit effort="100" velocity="100" />
      <joint_properties damping="0.0" friction="0.0" />
      <anchor xyz="0 0 0" />
    </joint>
	
    <gazebo reference="${prefix_y}_${prefix_x}_wheel_link" >
      <mu1>0.3</mu1>
      <mu2>0.3</mu2>
      <!-- <fdir1>1 0 0</fdir1> -->
      <kp>10000000.0</kp>
      <kd>1.0</kd>
      <!-- Increase min depth -->
      <minDepth>0.005</minDepth>
      <maxContacts>1</maxContacts>
    </gazebo>
        
	<!--	
		
    <transmission name="${prefix_y}_${prefix_x}_wheel_trans" >
	  <type>transmission_interface/SimpleTransmission</type>
      <joint name="${prefix_y}_${prefix_x}_wheel_joint" />
      <actuator name="${prefix_y}_${prefix_x}_motor_link">
	    <hardwareInterface>VelocityJointInterface</hardwareInterface>
        <mechanicalReduction>1.0</mechanicalReduction>
        <!- <motorTorqueConstant>1</motorTorqueConstant> ->
	  </actuator>
    </transmission>
	
	-->

  </xacro:macro>
    
</robot>
